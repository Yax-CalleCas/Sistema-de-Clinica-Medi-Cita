@model List<MediCita.Web.Entidades.ReporteCita>

<link href="~/css/Reportes.css" rel="stylesheet" />

<div class="container mt-4 mb-5">

    <!-- CABECERA -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body d-flex justify-content-between align-items-center">
            <div>
                <h4 class="fw-bold mb-0">Resultados de Citas Médicas</h4>
                <small class="text-muted">
                    Periodo: @ViewBag.FechaInicio — @ViewBag.FechaFin
                </small>
            </div>

            <div>
                <a asp-action="ExportarCitasPdf"
                   asp-route-fechaInicio="@ViewBag.FechaInicio"
                   asp-route-fechaFin="@ViewBag.FechaFin"
                   class="btn btn-dark btn-sm">
                    Imprimir PDF
                </a>

                <a asp-action="Index"
                   class="btn btn-outline-secondary btn-sm ms-2">
                    Nueva búsqueda
                </a>
            </div>
        </div>
    </div>

    <!-- BUSCADOR -->
    <input type="text" id="filtro"
           class="form-control form-control-sm mb-3"
           placeholder="Buscar por paciente, médico o estado">

    <!-- TABLA -->
    <div class="table-responsive shadow-sm">
        <table class="table table-hover align-middle mb-0">
            <thead class="table-light">
                <tr>
                    <th>Paciente</th>
                    <th>Médico</th>
                    <th class="text-center">Fecha</th>
                    <th class="text-center">Estado</th>
                </tr>
            </thead>
            <tbody id="tabla">
                @foreach (var item in Model)
                {
                    <tr>
                        <td>
                            <strong>@item.Paciente</strong>
                            <div class="text-muted small">ID #@item.IdCita</div>
                        </td>
                        <td>@item.Medico</td>
                        <td class="text-center">
                            @item.FechaCita.ToString("dd/MM/yyyy")
                        </td>
                        <td class="text-center">
                            @switch (item.Estado)
                            {
                                case "P":
                                    <span class="badge bg-warning">Pendiente</span>
                                    break;
                                case "A":
                                    <span class="badge bg-success">Atendida</span>
                                    break;
                                default:
                                    <span class="badge bg-danger">Cancelada</span>
                                    break;
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<script>
    document.getElementById("filtro").addEventListener("keyup", function () {
        const texto = this.value.toLowerCase();
        document.querySelectorAll("#tabla tr").forEach(fila => {
            fila.style.display = fila.innerText.toLowerCase().includes(texto) ? "" : "none";
        });
    });
</script>
